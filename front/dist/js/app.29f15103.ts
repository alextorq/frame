(function(e){function t(t){for(var r,o,i=t[0],u=t[1],s=t[2],f=0,m=[];f<i.length;f++)o=i[f],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&m.push(a[o][0]),a[o]=0;for(r in u)Object.prototype.hasOwnProperty.call(u,r)&&(e[r]=u[r]);l&&l(t);while(m.length)m.shift()();return c.push.apply(c,s||[]),n()}function n(){for(var e,t=0;t<c.length;t++){for(var n=c[t],r=!0,i=1;i<n.length;i++){var u=n[i];0!==a[u]&&(r=!1)}r&&(c.splice(t--,1),e=o(o.s=n[0]))}return e}var r={},a={app:0},c=[];function o(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=r,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],u=i.push.bind(i);i.push=t,i=i.slice();for(var s=0;s<i.length;s++)t(i[s]);var l=u;c.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"0c77":function(e,t,n){"use strict";n("4452")},4452:function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("7a23"),a={class:"menu"},c=Object(r["f"])("Suggest"),o=Object(r["f"])("Cinema"),i=Object(r["f"])("Weekly");function u(e,t,n,u,s,l){var f=Object(r["w"])("router-link"),m=Object(r["w"])("router-view");return Object(r["p"])(),Object(r["d"])(r["a"],null,[Object(r["g"])("div",a,[Object(r["g"])(f,{to:{name:"Suggest"}},{default:Object(r["E"])((function(){return[c]})),_:1}),Object(r["g"])(f,{to:{name:"Home"}},{default:Object(r["E"])((function(){return[o]})),_:1}),Object(r["g"])(f,{to:{name:"Weekly"}},{default:Object(r["E"])((function(){return[i]})),_:1})]),Object(r["g"])(m)],64)}var s={name:"App",data:function(){return{}},components:{},computed:{},methods:{}};n("9cdc");s.render=u;var l=s,f=n("3608");function m(e,t,n,a,c,o){return Object(r["p"])(),Object(r["d"])("div",{style:o.style,class:[c.classes,"cinema"]},[o.frame?(Object(r["p"])(),Object(r["d"])("img",{key:0,src:o.frame},null,8,["src"])):Object(r["e"])("",!0),Object(r["g"])("div",null,[(Object(r["p"])(!0),Object(r["d"])(r["a"],null,Object(r["v"])(c.currentCinema.title,(function(e,n){return Object(r["p"])(),Object(r["d"])("label",{class:"answer__item",key:n},[Object(r["F"])(Object(r["g"])("input",{type:"radio",name:"answer",value:e,onChange:t[1]||(t[1]=function(){return o.check.apply(o,arguments)}),"onUpdate:modelValue":t[2]||(t[2]=function(e){return c.title=e})},null,40,["value"]),[[r["A"],c.title]]),Object(r["f"])(" "+Object(r["y"])(e),1)])})),128))])],6)}n("99af"),n("d3b7"),n("3ca3"),n("ddb0");var d=n("3835"),b=(n("96cf"),n("1da1")),p=(n("4160"),n("4fad"),n("159b"),n("d4ec")),g=n("bee2"),h=n("bc3a"),v=n.n(h),O="http://localhost:3000/",j=function(){function e(t){Object(p["a"])(this,e),this.transport=t}return Object(g["a"])(e,[{key:"suggestCinema",value:function(e){return this.transport.post("".concat(O+"cinema/create"),e)}},{key:"convertToFormData",value:function(e){var t=new FormData;return Object.entries(e).forEach((function(e){var n=Object(d["a"])(e,2),r=n[0],a=n[1];t.append(r,a)})),t}},{key:"getFirstOrLastMemory",value:function(){return this.transport.get("".concat(O+"cinema/get_last_remember/"),{withCredentials:!0})}},{key:"getNext",value:function(e){return this.transport.get("".concat(O+"cinema/get_next/"+e),{withCredentials:!0})}},{key:"weekly",value:function(){return this.transport.get("".concat(O,"'cinema/weekly/"))}},{key:"answer",value:function(e){return this.transport.post("".concat(O+"cinema/answer"),e,{withCredentials:!0})}}]),e}(),w=new j(v.a);function y(e){for(var t=e.length/4,n={r:0,g:0,b:0,a:0},r=0;r<t;r++){var a=4*r;n.r+=e[a],n.g+=e[a+1],n.b+=e[a+2],n.a+=e[a+3]}return n.r=~~(n.r/t),n.g=~~(n.g/t),n.b=~~(n.b/t),n.a=~~(n.a/t),n}var k=function(e){return new Promise((function(t){var n=document.createElement("canvas"),r=n.getContext("2d"),a=new Image;a.src="http://localhost:3000/"+e,a.crossOrigin="Anonymous",a.addEventListener("load",(function(){var e=a.naturalWidth,c=a.naturalHeight;n.width=e,n.height=c,r.drawImage(a,0,0,e,c);var o=r.getImageData(0,0,e,c);t(y(o.data))}))}))},x={name:"Cinema",data:function(){return{classes:[],currentCinema:{title:[]},title:"",loading:!1,color:{r:0,g:0,b:0,a:1}}},computed:{style:function(){var e="linear-gradient(0deg, rgba(".concat(this.color.r,",").concat(this.color.g,",").concat(this.color.b,", 0.9),\n                  rgba(").concat(this.color.r,",").concat(this.color.g,",").concat(this.color.b,", 1) 80%)");return{background:e}},frame:function(){return"http://localhost:3000/"+this.currentCinema.frame}},methods:{getColor:function(){var e=this;return Object(b["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,k(e.currentCinema.frame[0]);case 2:n=t.sent,n&&(e.color.r=n.r,e.color.g=n.g,e.color.b=n.b);case 4:case"end":return t.stop()}}),t)})))()},delay:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2500;return new Promise((function(t){setTimeout(t,e)}))},clear:function(){this.title="",this.classes=[]},setCinema:function(e){this.currentCinema=e.data,this.getColor()},errorHandler:function(e){this.$router.push({name:"Finish"}),console.error(e)},check:function(){var e=this;return Object(b["a"])(regeneratorRuntime.mark((function t(){var n,r,a,c,o,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,e.title&&!e.loading){t.next=3;break}return t.abrupt("return");case 3:return e.loading=!0,t.next=6,w.answer({id:e.currentCinema._id,answer:e.title});case 6:return n=t.sent,r=n.data,a=r.answer?"correct":"wrong",e.classes.push(a),t.next=12,Promise.all([e.delay(),e.random()]);case 12:c=t.sent,o=Object(d["a"])(c,2),i=o[1],e.clear(),e.setCinema(i),e.loading=!1,t.next=23;break;case 20:t.prev=20,t.t0=t["catch"](0),e.errorHandler(t.t0);case 23:case"end":return t.stop()}}),t,null,[[0,20]])})))()},random:function(){return Object(b["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,w.getFirstOrLastMemory();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))()}},props:{cinema:{type:Object,default:function(){return{title:"",frame:""}}}},mounted:function(){var e=this;return Object(b["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e.clear(),t.next=4,e.random();case 4:n=t.sent,e.setCinema(n),t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0),e.errorHandler(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})))()}};n("0c77");x.render=m;var C=x,_=(n("b0c0"),Object(r["G"])("data-v-bc6b9586"));Object(r["s"])("data-v-bc6b9586");var R={class:"form__suggest"},F=Object(r["f"])(" Name of cinema ");Object(r["q"])();var P=_((function(e,t,n,a,c,o){return Object(r["p"])(),Object(r["d"])("div",R,[Object(r["F"])(Object(r["g"])("img",{src:c.src,alt:""},null,8,["src"]),[[r["C"],c.src]]),Object(r["g"])("div",null,[Object(r["g"])("label",null,[F,Object(r["F"])(Object(r["g"])("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=function(e){return c.name=e})},null,512),[[r["B"],c.name]])])]),Object(r["g"])("div",null,[Object(r["g"])("input",{type:"file",accept:"image/jpeg,image/png",onChange:t[2]||(t[2]=function(){return o.saveFile.apply(o,arguments)})},null,32)]),Object(r["g"])("button",{onClick:t[3]||(t[3]=function(){return o.suggest.apply(o,arguments)})},"Suggest")])})),S={name:"Suggest",data:function(){return{file:"",name:"",src:""}},computed:{},methods:{saveFile:function(e){var t=this;if(this.file=e.target.files[0],this.file){var n=new FileReader;n.onload=function(){t.src=n.result},n.readAsDataURL(this.file)}},suggest:function(){var e=this;return Object(b["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,n=w.convertToFormData({name:e.name,frame:e.file}),t.next=4,w.suggestCinema(n);case 4:t.next=9;break;case 6:t.prev=6,t.t0=t["catch"](0),console.error(t.t0);case 9:return t.prev=9,e.file="",e.name="",e.src="",t.finish(9);case 14:case"end":return t.stop()}}),t,null,[[0,6,9,14]])})))()}}};n("dd78");S.render=P,S.__scopeId="data-v-bc6b9586";var H=S,E={class:"finish"},M=Object(r["g"])("img",{src:"/finish.jpg",alt:""},null,-1),T=Object(r["g"])("div",null,"Вы выграли",-1),A=Object(r["f"])("добавте свои любимые фильмы");function D(e,t,n,a,c,o){var i=Object(r["w"])("router-link");return Object(r["p"])(),Object(r["d"])("div",E,[M,T,Object(r["g"])(i,{to:{name:"Suggest"}},{default:Object(r["E"])((function(){return[A]})),_:1})])}var I={name:"Finish"};n("7c28");I.render=D;var L=I;function U(e,t,n,a,c,o){return Object(r["p"])(),Object(r["d"])("div",{style:o.style,class:[c.classes,"cinema"]},[o.frame?(Object(r["p"])(),Object(r["d"])("img",{key:0,src:o.frame},null,8,["src"])):Object(r["e"])("",!0),Object(r["g"])("div",null,[(Object(r["p"])(!0),Object(r["d"])(r["a"],null,Object(r["v"])(c.currentCinema.title,(function(e,n){return Object(r["p"])(),Object(r["d"])("label",{class:"answer__item",key:n},[Object(r["F"])(Object(r["g"])("input",{type:"radio",name:"answer",value:e,onChange:t[1]||(t[1]=function(){return o.check.apply(o,arguments)}),"onUpdate:modelValue":t[2]||(t[2]=function(e){return c.title=e})},null,40,["value"]),[[r["A"],c.title]]),Object(r["f"])(" "+Object(r["y"])(e),1)])})),128))])],6)}var W={name:"Cinema",data:function(){return{classes:[],currentCinema:{title:[]},title:"",loading:!1,color:{r:0,g:0,b:0,a:1}}},computed:{style:function(){var e="linear-gradient(0deg, rgba(".concat(this.color.r,",").concat(this.color.g,",").concat(this.color.b,", 0.9),\n                  rgba(").concat(this.color.r,",").concat(this.color.g,",").concat(this.color.b,", 1) 80%)");return{background:e}},frame:function(){return"http://localhost:3000/"+this.currentCinema.frame}},methods:{getColor:function(){var e=this;return Object(b["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,k(e.currentCinema.frame[0]);case 2:n=t.sent,n&&(e.color.r=n.r,e.color.g=n.g,e.color.b=n.b);case 4:case"end":return t.stop()}}),t)})))()},delay:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2500;return new Promise((function(t){setTimeout(t,e)}))},clear:function(){this.title="",this.classes=[]},setCinema:function(e){this.currentCinema=e.data,this.getColor()},errorHandler:function(e){this.$router.push({name:"Finish"}),console.error(e)},check:function(){var e=this;return Object(b["a"])(regeneratorRuntime.mark((function t(){var n,r,a,c,o,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,e.title&&!e.loading){t.next=3;break}return t.abrupt("return");case 3:return e.loading=!0,t.next=6,w.answer({id:e.currentCinema._id,answer:e.title});case 6:return n=t.sent,r=n.data,a=r.answer?"correct":"wrong",e.classes.push(a),t.next=12,Promise.all([e.delay(),e.random()]);case 12:c=t.sent,o=Object(d["a"])(c,2),i=o[1],e.clear(),e.setCinema(i),e.loading=!1,t.next=23;break;case 20:t.prev=20,t.t0=t["catch"](0),e.errorHandler(t.t0);case 23:case"end":return t.stop()}}),t,null,[[0,20]])})))()},random:function(){return Object(b["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,w.weekly();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))()}},props:{cinema:{type:Object,default:function(){return{title:"",frame:""}}}},mounted:function(){var e=this;return Object(b["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e.clear(),t.next=4,e.random();case 4:n=t.sent,e.setCinema(n),t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0),e.errorHandler(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})))()}};n("5f79");W.render=U;var V=W,J=[{path:"/",name:"Home",component:C},{path:"/most__weekly",name:"Weekly",component:V},{path:"/suggest",name:"Suggest",component:H},{path:"/finish",name:"Finish",component:L}],N=Object(f["a"])({history:Object(f["b"])(),routes:J}),$=N;Object(r["c"])(l).use($).mount("#app")},"5f79":function(e,t,n){"use strict";n("a4a4")},"63de":function(e,t,n){},"7c28":function(e,t,n){"use strict";n("fea4")},"9cdc":function(e,t,n){"use strict";n("c701")},a4a4:function(e,t,n){},c701:function(e,t,n){},dd78:function(e,t,n){"use strict";n("63de")},fea4:function(e,t,n){}});
//# sourceMappingURL=app.29f15103.js.map